<Window x:Class="BetterEditor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:BetterEditor"
        xmlns:viewmodels="clr-namespace:BetterEditor.ViewModels"
        d:DataContext="{d:DesignInstance Type=viewmodels:MainViewModel}"
        mc:Ignorable="d"
        MinHeight="100" MinWidth="400"
        WindowStyle="None">
    <Window.DataContext>
        <viewmodels:MainViewModel/>
    </Window.DataContext>

    <Window.InputBindings>
        <KeyBinding Key="Tab" Modifiers="Shift" Command="{Binding ChangeUserControlCommand}"/>
        <KeyBinding Key="OemPlus" Modifiers="Ctrl" Command="{Binding ZoomInCommand}"/>
        <KeyBinding Key="OemMinus" Modifiers="Ctrl" Command="{Binding ZoomOutCommand}"/>
        <KeyBinding Key="F4" Modifiers="Alt" Command="{Binding CloseAppCommand}"/>
    </Window.InputBindings>

    <Window.Resources>
        <!-- Binding to ViewModes property -->
        <CollectionViewSource Source="{Binding Path=ViewModes}" x:Key="ViewModes"/>
        <Style TargetType="MenuItem">
            <Setter Property="Background" Value="Lightgray"/>
        </Style>
    </Window.Resources>
    <Grid Background="{Binding Settings.SVM.BGTE}" MouseLeftButtonUp="Window_MouseLeftButtonUp">
        <Grid.RowDefinitions>
            <RowDefinition Height="20"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" Margin="5,0,0,0" MouseLeftButtonDown="Window_MouseLeftButtonDown" MouseMove="MouseMoves">
            <Grid.RowDefinitions>
                <RowDefinition Height="9*"/>
                <RowDefinition Height="11*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition Width="40px"/>
                <ColumnDefinition Width="40px"/>
                <ColumnDefinition Width="40px"/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="BetterEditor" Grid.Column="0" Foreground="{Binding Settings.SVM.Foreground}" Grid.RowSpan="2"/>
            <Button HorizontalAlignment="Center" Grid.Column="1" Width="40px" Content="🗕" Click="MinimizeWindow" Grid.RowSpan="2"/>
            <Button HorizontalAlignment="Center" Grid.Column="2" Width="40px" Content="{Binding Path=DataContext.ChangeSizeButton, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type local:MainWindow}}}" Click="ChangeWindowSize" Grid.RowSpan="2"/>
            <Button HorizontalAlignment="Center" Grid.Column="3" Width="40px" Content="🗙" Grid.RowSpan="2" Command="{Binding CloseAppCommand}"/>
        </Grid>
        <Grid Grid.Row="1" Background="{Binding Settings.SVM.BGT}">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Menu Background="{Binding Settings.SVM.BGTE}">
                <MenuItem Header="File">
                    <MenuItem Header="New (Ctrl + T)" Command="{Binding OpenNewTabCommand}"/>
                    <MenuItem Header="Open (Ctrl + O)" Command="{Binding OpenFileCommand}"/>
                    <MenuItem Header="Save (Ctrl + S)" Command="{Binding SaveCommand}"/>
                    <MenuItem Header="Save as (Ctrl + Alt + S)" Command="{Binding SaveAsCommand}"/>
                    <MenuItem Header="Save automatically" IsCheckable="True" StaysOpenOnClick="True" Command="{Binding SaveAutomaticallyCommand}"/>
                    <MenuItem Header="Close and delete" IsCheckable="True" StaysOpenOnClick="True" Command="{Binding CADCommand}"/>
                    <MenuItem Header="Open settings file" Command="{Binding OpenSettingsFileCommand}"/>
                    <MenuItem Header="Close tab (Ctrl + W)" Command="{Binding CloseTabCommand}"/>
                    <MenuItem Header="Close BetterEditor (Alt + F4)" Command="{Binding CloseAppCommand}"/>
                </MenuItem>
                <MenuItem Header="Edit">
                    <MenuItem Header="Undo (Ctrl + Z)"/>
                    <MenuItem Header="Redo (Ctrl + Y)"/>
                    <MenuItem Header="Search (Ctrl + F)"/>
                    <MenuItem Header="Replace (Ctrl + R)"/>
                </MenuItem>
                <MenuItem Header="View">
                    <MenuItem Header="Zoom">
                        <MenuItem Header="Zoom in (Ctrl + '+')" Command="{Binding ZoomInCommand}"/>
                        <MenuItem Header="Zoom out (Ctrl + '-')" Command="{Binding ZoomOutCommand}"/>
                    </MenuItem>
                    <MenuItem Header="Viewmode (Ctrl + M)" >
                        <MenuItem.ItemsSource>
                            <!-- dynamically show list entries -->
                            <CompositeCollection>
                                <CollectionContainer Collection="{Binding Source={StaticResource ViewModes}}"/>
                            </CompositeCollection>
                        </MenuItem.ItemsSource>
                        <MenuItem.ItemContainerStyle>
                            <Style>
                                <Setter Property="MenuItem.Background" Value="white"/>
                                <Setter Property="MenuItem.Header" Value="{Binding Label}"/>
                                <Setter Property="MenuItem.Command" Value="{Binding Path=DataContext.ChangeViewModeCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type local:MainWindow}}}"/>
                                <Setter Property="MenuItem.CommandParameter" Value="{Binding}"/>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="Help" >
                    <MenuItem Header="Open license" />
                    <MenuItem Header="Open program info" />
                </MenuItem>
            </Menu>
            <ContentControl Content="{Binding UserControl}" Grid.Row="1"/>
        </Grid>
    </Grid>
</Window>